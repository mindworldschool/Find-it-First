/**
 * Translations for Find it First
 * Supported languages: UA, EN, RU, ES
 */

export const translations = {
  ua: {
    // Header
    gameTitle: "–ó–Ω–∞–π–¥–∏ –ü–µ—Ä—à–∏–º",
    gameSubtitle: "MindWorld School",
    
    // Menu
    playersCount: "–ö—ñ–ª—å–∫—ñ—Å—Ç—å –≥—Ä–∞–≤—Ü—ñ–≤",
    difficulty: "–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å",
    difficultyEasy: "–õ–µ–≥–∫–æ",
    difficultyMedium: "–°–µ—Ä–µ–¥–Ω—å–æ",
    difficultyHard: "–°–∫–ª–∞–¥–Ω–æ",
    cardsInfo: "–∫–∞—Ä—Ç ‚Ä¢ —Å–∏–º–≤–æ–ª—ñ–≤",
    startGame: "–ü–æ—á–∞—Ç–∏ –≥—Ä—É",
    
    // Game UI
    cardsRemaining: "–ó–∞–ª–∏—à–∏–ª–æ—Å—å:",
    timer: "‚è±Ô∏è",
    pause: "–ü–∞—É–∑–∞",
    exit: "–í–∏–π—Ç–∏",
    
    // Player names
    player: "–ì—Ä–∞–≤–µ—Ü—å",
    deck: "–ö–æ–ª–æ–¥–∞",
    
    // Pause modal
    pauseTitle: "–ü–∞—É–∑–∞",
    resume: "–ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏",
    exitToMenu: "–í–∏–π—Ç–∏ –≤ –º–µ–Ω—é",
    
    // Results
    gameOver: "–ì—Ä–∞ –∑–∞–∫—ñ–Ω—á–µ–Ω–∞!",
    collectedCards: "–ó—ñ–±—Ä–∞–Ω–æ –∫–∞—Ä—Ç",
    time: "–ß–∞—Å",
    accuracy: "–¢–æ—á–Ω—ñ—Å—Ç—å",
    playAgain: "–ì—Ä–∞—Ç–∏ –∑–Ω–æ–≤—É",
    toMenu: "–í –º–µ–Ω—é",
    
    // Loading
    loading: "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...",

    // Confirmations
    exitConfirmTitle: "–í–∏–π—Ç–∏ –∑ –≥—Ä–∏?",
    exitConfirm: "–¢–∞–∫, –≤–∏–π—Ç–∏",
    exitCancel: "–°–∫–∞—Å—É–≤–∞—Ç–∏",
    correctAnswers: "–ü—Ä–∞–≤–∏–ª—å–Ω–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π",
    wrongAnswers: "–ü–æ–º–∏–ª–∫–æ–≤–∏—Ö",
    cards: "–∫–∞—Ä—Ç",

    // Timer
    moveTime: "–ß–∞—Å –Ω–∞ —Ö—ñ–¥",
    timeUp: "–ß–∞—Å –≤–∏–π—à–æ–≤!"
  },

  en: {
    // Header
    gameTitle: "Find it First",
    gameSubtitle: "MindWorld School",
    
    // Menu
    playersCount: "Number of players",
    difficulty: "Difficulty",
    difficultyEasy: "Easy",
    difficultyMedium: "Medium",
    difficultyHard: "Hard",
    cardsInfo: "cards ‚Ä¢ symbols",
    startGame: "Start Game",
    
    // Game UI
    cardsRemaining: "Remaining:",
    timer: "‚è±Ô∏è",
    pause: "Pause",
    exit: "Exit",
    
    // Player names
    player: "Player",
    deck: "Deck",
    
    // Pause modal
    pauseTitle: "Pause",
    resume: "Resume",
    exitToMenu: "Exit to Menu",
    
    // Results
    gameOver: "Game Over!",
    collectedCards: "Cards Collected",
    time: "Time",
    accuracy: "Accuracy",
    playAgain: "Play Again",
    toMenu: "To Menu",
    
    // Loading
    loading: "Loading...",

    // Confirmations
    exitConfirmTitle: "Exit game?",
    exitConfirm: "Yes, exit",
    exitCancel: "Cancel",
    correctAnswers: "Correct answers",
    wrongAnswers: "Wrong answers",
    cards: "cards",

    // Timer
    moveTime: "Move time",
    timeUp: "Time's up!"
  },

  ru: {
    // Header
    gameTitle: "–ù–∞–π–¥–∏ –ü–µ—Ä–≤—ã–º",
    gameSubtitle: "MindWorld School",
    
    // Menu
    playersCount: "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–≥—Ä–æ–∫–æ–≤",
    difficulty: "–°–ª–æ–∂–Ω–æ—Å—Ç—å",
    difficultyEasy: "–õ–µ–≥–∫–æ",
    difficultyMedium: "–°—Ä–µ–¥–Ω–µ",
    difficultyHard: "–°–ª–æ–∂–Ω–æ",
    cardsInfo: "–∫–∞—Ä—Ç ‚Ä¢ —Å–∏–º–≤–æ–ª–æ–≤",
    startGame: "–ù–∞—á–∞—Ç—å –∏–≥—Ä—É",
    
    // Game UI
    cardsRemaining: "–û—Å—Ç–∞–ª–æ—Å—å:",
    timer: "‚è±Ô∏è",
    pause: "–ü–∞—É–∑–∞",
    exit: "–í—ã–π—Ç–∏",
    
    // Player names
    player: "–ò–≥—Ä–æ–∫",
    deck: "–ö–æ–ª–æ–¥–∞",
    
    // Pause modal
    pauseTitle: "–ü–∞—É–∑–∞",
    resume: "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å",
    exitToMenu: "–í—ã–π—Ç–∏ –≤ –º–µ–Ω—é",
    
    // Results
    gameOver: "–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!",
    collectedCards: "–°–æ–±—Ä–∞–Ω–æ –∫–∞—Ä—Ç",
    time: "–í—Ä–µ–º—è",
    accuracy: "–¢–æ—á–Ω–æ—Å—Ç—å",
    playAgain: "–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞",
    toMenu: "–í –º–µ–Ω—é",
    
    // Loading
    loading: "–ó–∞–≥—Ä—É–∑–∫–∞...",

    // Confirmations
    exitConfirmTitle: "–í—ã–π—Ç–∏ –∏–∑ –∏–≥—Ä—ã?",
    exitConfirm: "–î–∞, –≤—ã–π—Ç–∏",
    exitCancel: "–û—Ç–º–µ–Ω–∞",
    correctAnswers: "–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤",
    wrongAnswers: "–û—à–∏–±–æ–∫",
    cards: "–∫–∞—Ä—Ç",

    // Timer
    moveTime: "–í—Ä–µ–º—è –Ω–∞ —Ö–æ–¥",
    timeUp: "–í—Ä–µ–º—è –≤—ã—à–ª–æ!"
  },

  es: {
    // Header
    gameTitle: "Encu√©ntralo Primero",
    gameSubtitle: "MindWorld School",
    
    // Menu
    playersCount: "N√∫mero de jugadores",
    difficulty: "Dificultad",
    difficultyEasy: "F√°cil",
    difficultyMedium: "Medio",
    difficultyHard: "Dif√≠cil",
    cardsInfo: "cartas ‚Ä¢ s√≠mbolos",
    startGame: "Comenzar Juego",
    
    // Game UI
    cardsRemaining: "Restante:",
    timer: "‚è±Ô∏è",
    pause: "Pausa",
    exit: "Salir",
    
    // Player names
    player: "Jugador",
    deck: "Mazo",
    
    // Pause modal
    pauseTitle: "Pausa",
    resume: "Continuar",
    exitToMenu: "Salir al Men√∫",
    
    // Results
    gameOver: "¬°Juego Terminado!",
    collectedCards: "Cartas Recogidas",
    time: "Tiempo",
    accuracy: "Precisi√≥n",
    playAgain: "Jugar de Nuevo",
    toMenu: "Al Men√∫",
    
    // Loading
    loading: "Cargando...",

    // Confirmations
    exitConfirmTitle: "¬øSalir del juego?",
    exitConfirm: "S√≠, salir",
    exitCancel: "Cancelar",
    correctAnswers: "Respuestas correctas",
    wrongAnswers: "Errores",
    cards: "cartas",

    // Timer
    moveTime: "Tiempo por turno",
    timeUp: "¬°Se acab√≥ el tiempo!"
  }
};

/**
 * –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–µ—Ä–µ–∫–ª–∞–¥ –¥–ª—è –ø–æ—Ç–æ—á–Ω–æ—ó –º–æ–≤–∏
 */
export function t(key, lang = 'ua') {
  return translations[lang]?.[key] || translations.ua[key] || key;
}

/**
 * –í–∏–∑–Ω–∞—á–∏—Ç–∏ –º–æ–≤—É –∑ URL –∞–±–æ –±—Ä–∞—É–∑–µ—Ä–∞
 */
export function detectLanguage() {
  // 1. –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ (?lang=ua)
  const urlParams = new URLSearchParams(window.location.search);
  const urlLang = urlParams.get('lang');
  if (urlLang && translations[urlLang]) {
    console.log(`üåç Language detected from URL parameter: ${urlLang}`);
    return urlLang;
  }

  // 2. –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –∑ –ø–æ—Ç–æ—á–Ω–æ–≥–æ URL —à–ª—è—Ö—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, /en/finditfirst)
  const currentPath = window.location.pathname.toLowerCase();
  console.log(`üåç Checking current path: ${currentPath}`);

  if (currentPath.includes('/ua/') || currentPath.includes('/uk/')) {
    console.log('üåç Language detected from current path: ua');
    return 'ua';
  }
  if (currentPath.includes('/en/') || currentPath.includes('/english/')) {
    console.log('üåç Language detected from current path: en');
    return 'en';
  }
  if (currentPath.includes('/ru/') || currentPath.includes('/russian/')) {
    console.log('üåç Language detected from current path: ru');
    return 'ru';
  }
  if (currentPath.includes('/es/') || currentPath.includes('/spanish/')) {
    console.log('üåç Language detected from current path: es');
    return 'es';
  }

  // 3. –Ø–∫—â–æ –≤—ñ–¥–∫—Ä–∏—Ç–æ –≤ iframe, —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –∑ URL –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–æ–≥–æ –≤—ñ–∫–Ω–∞
  try {
    if (window.parent && window.parent !== window) {
      // –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ—Ç—Ä–∏–º–∞—Ç–∏ URL –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–æ–≥–æ –≤—ñ–∫–Ω–∞ (–ø—Ä–∞—Ü—é—î —è–∫—â–æ —Ç–æ–π —Å–∞–º–∏–π –¥–æ–º–µ–Ω)
      const parentUrl = window.parent.location.href.toLowerCase();
      console.log(`üåç Checking parent URL: ${parentUrl}`);

      if (parentUrl.includes('/ua/') || parentUrl.includes('/uk/') || parentUrl.includes('.ua/') || parentUrl.includes('lang=ua') || parentUrl.includes('lang=uk')) {
        console.log('üåç Language detected from parent URL: ua');
        return 'ua';
      }
      if (parentUrl.includes('/en/') || parentUrl.includes('/english/') || parentUrl.includes('lang=en')) {
        console.log('üåç Language detected from parent URL: en');
        return 'en';
      }
      if (parentUrl.includes('/ru/') || parentUrl.includes('/russian/') || parentUrl.includes('.ru/') || parentUrl.includes('lang=ru')) {
        console.log('üåç Language detected from parent URL: ru');
        return 'ru';
      }
      if (parentUrl.includes('/es/') || parentUrl.includes('/spanish/') || parentUrl.includes('.es/') || parentUrl.includes('lang=es')) {
        console.log('üåç Language detected from parent URL: es');
        return 'es';
      }
    }
  } catch (e) {
    // Cross-origin iframe - –Ω–µ –º–∞—î–º–æ –¥–æ—Å—Ç—É–ø—É –¥–æ parent.location
    console.log('üåç Cannot access parent URL (cross-origin), checking referrer...');
  }

  // 4. –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –∑ referrer URL
  const referrer = document.referrer.toLowerCase();
  if (referrer) {
    console.log(`üåç Checking referrer: ${referrer}`);

    // Check for language indicators in referrer URL
    if (referrer.includes('/ua/') || referrer.includes('/uk/') || referrer.includes('.ua/') || referrer.includes('lang=ua') || referrer.includes('lang=uk')) {
      console.log('üåç Language detected from referrer: ua');
      return 'ua';
    }
    if (referrer.includes('/en/') || referrer.includes('/english/') || referrer.includes('lang=en')) {
      console.log('üåç Language detected from referrer: en');
      return 'en';
    }
    if (referrer.includes('/ru/') || referrer.includes('/russian/') || referrer.includes('.ru/') || referrer.includes('lang=ru')) {
      console.log('üåç Language detected from referrer: ru');
      return 'ru';
    }
    if (referrer.includes('/es/') || referrer.includes('/spanish/') || referrer.includes('.es/') || referrer.includes('lang=es')) {
      console.log('üåç Language detected from referrer: es');
      return 'es';
    }
  }

  // 5. –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –∑ –º–æ–≤–∏ –±—Ä–∞—É–∑–µ—Ä–∞
  const browserLang = navigator.language.toLowerCase();
  console.log(`üåç Browser language: ${browserLang}`);

  if (browserLang.startsWith('uk')) {
    console.log('üåç Language detected from browser: ua');
    return 'ua';
  }
  if (browserLang.startsWith('ru')) {
    console.log('üåç Language detected from browser: ru');
    return 'ru';
  }
  if (browserLang.startsWith('es')) {
    console.log('üåç Language detected from browser: es');
    return 'es';
  }
  if (browserLang.startsWith('en')) {
    console.log('üåç Language detected from browser: en');
    return 'en';
  }

  // 6. –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —É–∫—Ä–∞—ó–Ω—Å—å–∫–∞
  console.log('üåç Using default language: ua');
  return 'ua';
}
